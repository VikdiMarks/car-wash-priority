(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{92561:function(t,e,n){Promise.resolve().then(n.bind(n,77266))},85029:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var a=n(57437),o=n(2265),s=n(63251),r=n(47651),i=n(56887),c=n(86799),l=n(48793);function u(t){let{text:e,list:n,buttonClassName:u,menuClassName:d,itemClassName:h,callback:x,defaultValue:f}=t,[m,p]=o.useState(new Set([f?f.text:e])),g=o.useMemo(()=>Array.from(m).join(", ").replaceAll("_"," "),[m]);return(0,o.useEffect)(()=>{x(g)},[m]),(0,a.jsxs)(s.F,{children:[(0,a.jsx)(r.S,{children:(0,a.jsx)(i.A,{variant:"bordered",className:u,children:g})}),(0,a.jsx)(c.a,{"aria-label":"Single selection example",variant:"flat",disallowEmptySelection:!0,selectionMode:"single",selectedKeys:m,onSelectionChange:p,className:d,children:n.map(t=>(0,a.jsx)(l.W,{className:h,children:t.text},t.text))})]})}},77266:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return g}});var a=n(57437),o=n(2265),s=n(35048),r=n(3168),i=n(16573),c=n(2047),l=n(24235),u=n(50039),d=n(19223),h=n(50117),x=n(30604);async function f(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(()=>{let t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1)})();try{let e=await h.b.get("".concat("https://eco.null-it.com","/api/v2/organizations/").concat((0,x.v)("organization_id"),"/transactions/month?month=").concat(t));if(200===e.status){let t={};if(e.data){for(let n in console.log("getTransactionsMonth",e.data),e.data)t[n]={},t[n].day=new Date(n).getDate(),t[n].value=e.data[n];return console.log("getTransactionsMonth res",t),Object.values(t)}}return console.error("getDataLineChart",e.status),!1}catch(t){return console.error("getDataLineChart:",t),!1}}var m=n(85029),p=n(13477);function g(){let[t,e]=(0,o.useState)(!0),[n,h]=(0,o.useState)(0),[x,g]=(0,o.useState)(0),[b,v]=(0,o.useState)([]),[w,y]=(0,o.useState)({}),j=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"].filter((t,e)=>e<=new Date().getMonth()).map((t,e)=>({text:t,currentMonth:e===new Date().getMonth()})),[k,_]=(0,o.useState)(j.findIndex(t=>t.currentMonth)),[N,z]=(0,o.useState)(new Date);return(0,o.useEffect)(()=>{let t=async()=>{try{let t=await f(new Date().getFullYear()+"-"+(k+1));z(e=>((e=new Date).setDate(e.getDate()+(t.predicted_day_count?t.predicted_day_count:0)),e)),t&&v(t)}catch(t){console.error(t)}};t()},[k]),(0,o.useEffect)(()=>{let t=async()=>{let t=await (0,p.D2)();t&&y(t)};t()},[]),(0,a.jsxs)("section",{children:[(0,a.jsxs)("div",{className:"flex items-stretch gap-7 lg:gap-4 h-full flex-wrap",children:[(0,a.jsxs)("div",{className:"p-6 md:p-3.5 rounded-2xl bg-[#F7F9FB] min-h-full md:w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h6",{className:"text-black-100 font-semibold text-lg",children:"Аналитика счета"}),(0,a.jsx)("div",{className:"px-2 py-1 rounded-lg bg-black-100 text-sm text-white",children:function(){let t=new Date,e=t.toLocaleString("ru",{month:"long"}),n=t.getFullYear();return"".concat(e," ").concat(n)}()})]}),(0,a.jsxs)("div",{className:"flex items-center mt-4 gap-7 md:gap-4 text-black-100 text-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{children:"Израсходовано"}),(0,a.jsxs)("div",{className:"text-center rounded-lg bg-black/5 mt-1 w-[160px] relative h-6 overflow-y-hidden",children:[(0,a.jsx)("div",{className:"w-full bg-indigo-200 h-full absolute right-full translate-x-0 transition duration-300 ease-in-out",style:{transform:"translateX(".concat(w.spent_percent_balance?w.spent_percent_balance:0,"%)")}}),(0,a.jsxs)("span",{className:"block text-center text-zinc-900 text-lg font-semibold absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10",children:[w.spent_percent_balance?w.spent_percent_balance:0,"%"]})]})]}),(0,a.jsx)("div",{className:"w-[1px] h-[52px] bg-black/10"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Закончатся"}),(0,a.jsx)("p",{className:"text-lg font-semibold mt-1",children:N.toLocaleString("ru",{month:"long"})+" "+N.getDate()})]})]})]}),(0,a.jsxs)("div",{className:"p-6 rounded-2xl bg-[#E3F5FF] min-h-full min-w-[230px] md:w-full",children:[(0,a.jsx)("h6",{className:"text-sm font-semibold text-black-100 mb-2",children:"Всего моек"}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("p",{className:"text-2xl font-semibold text-black-100",children:w.month?w.month.operation_count:0})})]}),(0,a.jsxs)("div",{className:"p-6 rounded-2xl bg-[#E5ECF6] min-h-full min-w-[230px] md:w-full",children:[(0,a.jsx)("h6",{className:"text-sm font-semibold text-black-100 mb-2",children:"Потрачено средств"}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("p",{className:"text-2xl font-semibold text-black-100",children:String(w.month?w.month.spent:0).replace(".",",")})})]})]}),(0,a.jsxs)("div",{className:"mt-11 px-6 md:px-3.5 py-4 bg-[#F7F9FB] rounded-2xl relative",children:[(0,a.jsxs)("div",{className:"mb-5 w-full flex items-center justify-between",children:[(0,a.jsx)("h6",{className:"font-semibold text-sm text-black-100",children:"Статистика"}),(0,a.jsx)("div",{className:"w-[200px]",children:(0,a.jsx)(m.Z,{text:"Выберите дату",list:j,buttonClassName:"w-full border border-black/10 bg-white/80 rounded-lg text-sm px-4 py-1 placeholder:text-black/20 text-black-100",menuClassName:"w-full border border-black/10 bg-white/80 rounded-lg w-[200px] text-center",itemClassName:"w-full flex justify-center items-center py-1 hover:border-[#F7F9FB] hover:bg-[#F7F9FB] rounded-lg hover:border-black/10",callback:t=>_(j.findIndex(e=>e.text===t)),defaultValue:j.find(t=>t.currentMonth)})})]}),(0,a.jsx)(s.h,{width:"100%",height:260,children:(0,a.jsxs)(r.w,{width:"100%",height:"100%",data:b,children:[(0,a.jsx)(i.q,{vertical:!1,stroke:"#000",strokeOpacity:.05}),(0,a.jsx)(c.u,{contentStyle:{borderRadius:"10px"}}),(0,a.jsx)(l.K,{dataKey:"day",padding:{left:35,right:35}}),(0,a.jsx)(u.B,{}),(0,a.jsx)(d.x,{activeDot:{width:"30px",fill:"#A8C5DA",strokeWidth:3,stroke:"#ffffff",r:5},dot:!1,type:"monotone",dataKey:"value",name:"Потрачено",stroke:"#26AD60",strokeWidth:3})]})})]})]})}},13477:function(t,e,n){"use strict";n.d(e,{ss:function(){return x},D2:function(){return d},cK:function(){return h},YD:function(){return r},CH:function(){return u},pF:function(){return l},a_:function(){return c},eq:function(){return i}});var a=n(29222),o=n(50117);function s(t){let e=document.cookie.match(RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return console.log({operation:"readCookie",matches:e,name:t}),e?decodeURIComponent(e[1]):void 0}async function r(t){try{let e=await a.Z.post("".concat("https://eco.null-it.com","/api/v2/organizations/registration/create"),t);if(document.cookie="organization_id=; expires=-1;",document.cookie="phone=; expires=-1;",200===e.status)return document.cookie="organization_id="+e.data.organization_id,document.cookie="phone="+t.phone,!0;return console.log("Произошла ошибка в запросе на авторизацию:",e.status),!1}catch(t){return console.log("Произошла ошибка в запросе на авторизацию:",t),t.response.data}}async function i(t){try{let e=await a.Z.post("".concat("https://eco.null-it.com","/api/v2/organizations/registration/auth"),t);if(document.cookie="bearer_token=;expires=Thu, 01 Jan 1970 00:00:00 GMT;",200!==e.status)return console.log("Неудачная проверка номера:",e.status),e;{let t=new Date(e.data.auth.expires_at).getTime();return document.cookie="bearer_token="+e.data.auth.bearer_token+"; path=/; samesite=lax; expires="+new Date(t).toUTCString(),!0}}catch(t){return console.log("Неудачная проверка номера:",t),t.response.data.errors}}async function c(t){try{let e=await o.b.post("/api/v2/organizations/".concat(s("organization_id"),"/registration/set-data"),t);if(200===e.status)return!0;return console.log("Неудачное заполнение данных:",e.status),!1}catch(t){return console.log("Неудачное заполнение данных:",t),t.response.data.errors}}async function l(t){try{let e=await o.b.post("/api/v2/organizations/".concat(s("organization_id"),"/registration/set-pay-data"),t);if(200===e.status)return!0;return console.log("Неудачное заполнение данных:",e.status),!1}catch(t){return console.log("Неудачное заполнение данных:",t),t.response.data.errors}}async function u(t){try{let e=await o.b.post("/api/v2/organizations/".concat(s("organization_id"),"/registration/set-contact-data"),t);if(200===e.status)return!0;return console.log("Неудачное заполнение данных:",e.status),!1}catch(t){return console.log("Неудачное заполнение данных:",t),t.response.data.errors}}async function d(){try{let t=await o.b.get("".concat("https://eco.null-it.com","/api/v2/organizations/").concat(s("organization_id")));if(200===t.status)return t.data.data;return console.log("Неудачная проверка данных:",t.status),!1}catch(t){return console.log("Неудачная проверка данных:",t),t.response.data.errors}}async function h(){try{let t=await o.b.get("".concat("https://eco.null-it.com","/api/v2/organizations/").concat(s("organization_id"),"/registration/get-pay-data"));if(200===t.status)return t.data;return console.log("get-pay-data:",t.status),!1}catch(t){return console.log("get-pay-data:",t),t.response.data.errors}}async function x(t){try{let e=await o.b.post("/api/v2/organizations/".concat(s("organization_id"),"/invoices/create-by-calc"),t);if(200===e.status||201===e.status)return e.data.organization_invoice;return console.log("Неудачное заполнение данных:",e.status),!1}catch(t){return console.log("Неудачное заполнение данных:",t),t.response.data.errors}}},50117:function(t,e,n){"use strict";n.d(e,{b:function(){return s}});var a=n(29222),o=n(30604);let s=a.Z.create({baseURL:"https://eco.null-it.com"});s.interceptors.request.use(t=>(t.headers.Authorization="Bearer "+(0,o.v)("bearer_token"),t))},30604:function(t,e,n){"use strict";function a(t){if("undefined"!=typeof document){let e=document.cookie.match(RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}}n.d(e,{v:function(){return a}})}},function(t){t.O(0,[191,762,309,282,971,596,744],function(){return t(t.s=92561)}),_N_E=t.O()}]);